# Deployment Environment Variables - Cache Permission Fixes
# These variables are automatically applied during deployment to fix Node.js module access issues

# Core cache fixes
export NPM_CONFIG_CACHE=/tmp/.npm
export DISABLE_NPM_CACHE=true  
export DISABLE_OPENCOLLECTIVE=true
export NODE_OPTIONS="--max-old-space-size=4096"
export KEEP_DEV_DEPENDENCIES=true

# Additional npm settings to prevent cache issues
export NPM_CONFIG_PROGRESS=false
export NPM_CONFIG_LOGLEVEL=warn
export NPM_CONFIG_CACHE_MIN=0
export NPM_CONFIG_AUDIT=false
export NPM_CONFIG_FUND=false
export NPM_CONFIG_UPDATE_NOTIFIER=false

# Production environment
export NODE_ENV=production
export PORT=5000

# Clear cache and create safe cache directory
rm -rf node_modules/.cache 2>/dev/null || true
rm -rf .cache 2>/dev/null || true
mkdir -p /tmp/.npm
chmod 755 /tmp/.npm