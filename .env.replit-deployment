# Enhanced Replit Deployment Configuration
# Complete cache isolation and permission fix

# Node.js Configuration
NODE_ENV=production
NODE_OPTIONS="--max-old-space-size=4096 --max-semi-space-size=1024 --no-experimental-fetch"

# Enhanced NPM Cache Configuration
NPM_CONFIG_CACHE=/tmp/.npm-deployment-cache
NPM_CONFIG_TMP=/tmp
NPM_CONFIG_INIT_CACHE=/tmp/.npm-deployment-init
NPM_CONFIG_PREFIX=/tmp/.npm-deployment-prefix
NPM_CONFIG_STORE_DIR=/tmp/.npm-deployment-store
NPM_CONFIG_GLOBALCONFIG=/tmp/.npmrc-deployment-global
NPM_CONFIG_USERCONFIG=/tmp/.npmrc-deployment-user

# Disable ALL problematic npm features that cause permission issues
DISABLE_NPM_CACHE=true
DISABLE_OPENCOLLECTIVE=true
NPM_CONFIG_PROGRESS=false
NPM_CONFIG_LOGLEVEL=warn
NPM_CONFIG_AUDIT=false
NPM_CONFIG_FUND=false
NPM_CONFIG_UPDATE_NOTIFIER=false
NPM_CONFIG_PACKAGE_LOCK=false
NPM_CONFIG_SHRINKWRAP=false
NPM_CONFIG_SAVE=false
NPM_CONFIG_SAVE_DEV=false
NPM_CONFIG_SAVE_OPTIONAL=false
NPM_CONFIG_SAVE_EXACT=false

# Cache Control Settings
NPM_CONFIG_CACHE_MAX=0
NPM_CONFIG_CACHE_MIN=0
NPM_CONFIG_CACHE_LOCK_RETRIES=1
NPM_CONFIG_CACHE_LOCK_STALE=10000
NPM_CONFIG_CACHE_LOCK_WAIT=1000

# Network and Timeout Settings
NPM_CONFIG_REGISTRY_TIMEOUT=15000
NPM_CONFIG_FETCH_TIMEOUT=15000
NPM_CONFIG_FETCH_RETRIES=1
NPM_CONFIG_FETCH_RETRY_FACTOR=1
NPM_CONFIG_FETCH_RETRY_MINTIMEOUT=1000
NPM_CONFIG_FETCH_RETRY_MAXTIMEOUT=3000

# Additional Safety Settings
NPM_CONFIG_PREFER_ONLINE=true
NPM_CONFIG_UNSAFE_PERM=true
NPM_CONFIG_IGNORE_SCRIPTS=false

# Application Settings
PORT=5000
